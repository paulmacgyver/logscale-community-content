name: claroty-cef
tests:
- |
  <12>Jan 21 2022 09:56:23 claroty CEF:0|Claroty|CTD|4.2.2|HealthCheck|HealthCheck|0|rt=Jan 21 2022 09:56:23|start=Jan 21 2022 09:56:23  cs1Label=Site cs1=CS_TEST cs2Label=cpu cs2=1.42 cs3Label=mem cs3=64.5 cs4Label=used__opt_icsranger cs4=68.42 cs5Label=used__var cs5=68.42 cs6Label=used__tmp cs6=68.42 cs7Label=used__etc cs7=68.42 cs8Label=busy_sda cs8=0.7 cs9Label=busy_sda1 cs9=0.0 cs10Label=busy_sda2 cs10=0.7 cs11Label=busy_sr0 cs11=0.0 cs12Label=busy_dm-0 cs12=0.69 cs13Label=busy_dm-1 cs13=0.0 cs14Label=drop_lo cs14=0 cs15Label=drop_ens192 cs15=0 cs16Label=drop_ens224 cs16=0 cs17Label=netif_up_ens192 cs17=functional cs18Label=netif_up_ens224 cs18=functional cs19Label=q_baseline_tracker cs19=0 cs20Label=q_bridge cs20=0 cs21Label=q_central_bridge cs21=0 cs22Label=q_concluding cs22=0 cs23Label=q_diode_feeder cs23=0 cs24Label=q_dissector-0 cs24=0 cs25Label=q_dissector_ng cs25=0 cs26Label=q_enricher cs26=0 cs27Label=q_leecher cs27=0 cs28Label=q_monitor cs28=0 cs29Label=q_network_statistics cs29=0 cs30Label=q_packets cs30=0 cs31Label=q_packets_errors cs31=0 cs32Label=q_preprocessing cs32=942 cs33Label=q_preprocessing_ng cs33=0 cs34Label=q_processing cs34=0 cs35Label=q_processing_high cs35=0 cs36Label=q_statistics_ng cs36=0 cs37Label=q_zordon_updates cs37=0 cs38Label=queue_purge cs38=19 cs39Label=rd_bridge cs39=6 cs40Label=rd_dissector-0 cs40=24 cs41Label=rd_dissector_ng cs41=4 cs42Label=rd_preprocessing cs42=5 cs43Label=rd_preprocessing_ng cs43=0 cs44Label=service_mariadb cs44=Up cs45Label=service_postgres cs45=Up cs46Label=service_redis cs46=Up cs47Label=service_rabbitmq cs47=Up cs48Label=service_icsranger cs48=Up cs49Label=service_watchdog cs49=Up cs50Label=service_firewalld cs50=Up cs51Label=exceptions cs51=0 cs52Label=input_packet_drops cs52=0.0 cs53Label=output_packet_drops cs53=0.03699640390379162 cs54Label=full_output_packet_drops cs54=0.0 cs55Label=dissector_ng_packet_drops cs55=0.0 cs56Label=tag_artifacts_drops_Preprocessor cs56=0 cs57Label=tag_artifacts_drops_Preprocessor (Summaries) cs57=0 cs58Label=tag_artifacts_drops_Processor cs58=0 cs59Label=tag_artifacts_drops_Processor (Summaries) cs59=0 cs60Label=tag_artifacts_drops_Sniffer cs60=0 cs61Label=tag_artifacts_drops_Sniffer (Summaries) cs61=0 cs62Label=tag_artifacts_drops_Dissector PYPY cs62=0 cs63Label=tag_artifacts_drops_Dissector PYPY (Summaries) cs63=0 cs64Label=looping_call_duration_ProcessorWorker.reclassify_subnets cs64=6.8361 cs65Label=looping_call_duration_YaraScanner._scan_exported_files cs65=1.761 cs66Label=looping_call_duration_InsightsWorker._run_insights cs66=1.2672 cs67Label=looping_call_duration_NetworkStatisticsCacheManager.flush cs67=1.197 cs68Label=capsaver_folder_cleanup cs68=True cs69Label=dissection_coverage cs69=0.7651 cs70Label=dissection_efficiency_DHCP cs70=14.1264 cs71Label=dissection_efficiency_LLDP cs71=31.2642 cs72Label=dissection_efficiency_NTP cs72=4.9956 cs73Label=dissection_efficiency_HTTP cs73=18.6549 cs74Label=dissection_efficiency_DNS cs74=6.6332 cs75Label=dissection_efficiency_ICMP cs75=7.2972 cs76Label=dissection_efficiency_MODBUS cs76=18.7916 cs77Label=dissection_efficiency_IGMP cs77=7.7263 cs78Label=dissection_efficiency_SNMP cs78=11.3629 cs79Label=logrotate_size_test_cacher.log cs79=9785691 cs80Label=logrotate_size_test_baseline_tracker.error.log cs80=9954790 cs81Label=logrotate_size_test_cloud_client.log cs81=8265930 cs82Label=logrotate_size_test_bridge.log cs82=10180563 cs83Label=logrotate_mtime_test_authentication.stderr.log cs83=31889532.0440495 cs84Label=logrotate_mtime_test_configurator._.stdout.log cs84=31889531.981049538 cs85Label=logrotate_mtime_test_configurator._.error.log cs85=31889531.235048532 cs86Label=logrotate_mtime_test_configurator._.1.error.log cs86=31889530.67704773 cs87Label=logrotate_mtime_test_web._ranger.stdout.log cs87=31889529.42404604 cs88Label=logrotate_mtime_test_web._auth.stdout.log cs88=31889529.42404604 cs89Label=logrotate_mtime_test_web.nginx.stdout.log cs89=31889529.423046112 cs90Label=logrotate_mtime_test_web_nginx_error.log cs90=9717258.110060215 cs91Label=logrotate_mtime_test_web._auth.error.log cs91=31889528.31604457 cs92Label=logrotate_mtime_test_web._auth.1.error.log cs92=9807835.184176207 cs93Label=logrotate_mtime_test_web._auth.2.error.log cs93=9807835.146176338 cs94Label=logrotate_mtime_test_processor.stdout.log cs94=9717722.857961655 cs95Label=logrotate_mtime_test_processor.stderr.log cs95=9717722.856961727 cs96Label=logrotate_mtime_test_concluder.stdout.log cs96=9717722.848961353 cs97Label=logrotate_mtime_test_preprocessor-0.stdout.log cs97=5585893.246386051 cs98Label=logrotate_mtime_test_concluder.stderr.log cs98=9717722.847961426 cs99Label=logrotate_mtime_test_baseline_tracker.stdout.log cs99=9717722.837960958 cs100Label=logrotate_mtime_test_capsaver.stdout.log cs100=9717722.834960938 cs101Label=logrotate_mtime_test_preprocessor-0.stderr.log cs101=5585893.321388245 cs102Label=logrotate_mtime_test_leecher.stdout.log cs102=9717722.832960844 cs103Label=logrotate_mtime_test_baseline_tracker.stderr.log cs103=9717722.831960917 cs104Label=logrotate_mtime_test_leecher.stderr.log cs104=9717722.831960917 cs105Label=logrotate_mtime_test_capsaver.stderr.log cs105=9717722.823960543 cs106Label=logrotate_mtime_test_export_data.stdout.log cs106=9717722.804960012 cs107Label=logrotate_mtime_test_export_data.stderr.log cs107=9717722.804960012 cs108Label=logrotate_mtime_test_sensor.stdout.log cs108=9717722.75195837 cs109Label=logrotate_mtime_test_sensor.stderr.log cs109=9717722.75195837 cs110Label=logrotate_mtime_test_cloud_agent.stdout.log cs110=9717722.743957996 cs111Label=logrotate_mtime_test_cloud_agent.stderr.log cs111=9717722.742958069 cs112Label=logrotate_mtime_test_mailer.stderr.log cs112=9717722.686956167 cs113Label=logrotate_mtime_test_insights.stderr.log cs113=9717722.659955263 cs114Label=logrotate_mtime_test_cloud_agent.error.log cs114=5010474.6729159355 cs115Label=logrotate_mtime_test_mailer.error.log cs115=9717719.281847 cs116Label=logrotate_mtime_test_cloud_client.stdout.log cs116=9717719.266846657 cs117Label=logrotate_mtime_test_cloud_client.stderr.log cs117=9717719.254846096 cs118Label=logrotate_mtime_test_dissector-0.stdout.log cs118=9717719.15584302 cs119Label=logrotate_mtime_test_dissector-0.stderr.log cs119=9717719.15584302 cs120Label=logrotate_mtime_test_capsaver.error.log cs120=9717718.147810698 cs121Label=logrotate_mtime_test_sensor.error.log cs121=9717717.547791481 cs122Label=logrotate_mtime_test_known_threats.stdout.log cs122=9717717.024774551 cs123Label=logrotate_mtime_test_known_threats.stderr.log cs123=9717717.024774551 cs124Label=logrotate_mtime_test_active.stdout.log cs124=9717716.965772867 cs125Label=logrotate_mtime_test_active.stderr.log cs125=9717716.965772867 cs126Label=logrotate_mtime_test_enricher.stdout.log cs126=9717715.612729311 cs127Label=logrotate_mtime_test_enricher.stderr.log cs127=9717715.612729311 cs128Label=logrotate_mtime_test_cacher.stdout.log cs128=9717715.572728157 cs129Label=logrotate_mtime_test_cacher.stderr.log cs129=9717715.572728157 cs130Label=logrotate_mtime_test_bridge.stdout.log cs130=9717713.549663305 cs131Label=logrotate_mtime_test_bridge.stderr.log cs131=9717713.54866314 cs132Label=logrotate_mtime_test_preprocessor-0.error.log cs132=5585893.254386187 cs133Label=logrotate_mtime_test_enricher.error.log cs133=9717710.180555344 cs134Label=logrotate_mtime_test_active.error.log cs134=9717708.97151661 cs135Label=logrotate_mtime_test_export_data.error.log cs135=9717708.648506165 cs136Label=logrotate_mtime_test_bridge.error.log cs136=9717706.725444555 cs137Label=unhandled_events cs137=0 cs138Label=conclude_time cs138=0 cs139Label=mysql_query cs139=0.37 cs140Label=postgres_query cs140=0.02 cs141Label=dropped_entities cs141=0 cs142Label=psql_idle_sessions cs142=60 cs143Label=psql_idle_in_transaction_sessions cs143=0 cs144Label=yara_scanner_test cs144=[] cs145Label=sniffer_status cs145=[] cs146Label=workers cs146=26 cs147Label=workers_stop cs147=0 cs148Label=workers_restart cs148=0 msg=Successfully ran health monitoring
- '<12>Jan 21 2022 00:37:15 claroty CEF:0|Claroty|CTD|4.2.2|Event|Baseline Deviation|5|rt=Jan
  21 2022 00:37:15|start=Jan 21 2022 00:36:51 cn1Label=SiteId cn1=1 cs1Label=Site
  cs1=CS_TEST cs2Label=Network cs2=Default cs3Label=ResolvedAs cs3=Unresolved cs5Label=Src
  Zone cs5=Endpoint: Other cs6Label=Dst Zone cs6=Endpoint: Other cs7Label=Category
  cs7=Security cs8Label=AlertUrl cs8=https://192.168.1.110/alert/15689-1 outcome=Unresolved
  request=https://192.168.1.110/alert/15689-1 cn2Label=Alert Score cn2=100 cs10Label=PrimaryAssetIP
  cs10=192.168.1.20,192.168.1.79,192.168.1.93,fdac:2fd9:d2ff:41af:148d:e82e:cacb:bada,fdac:2fd9:d2ff:41af:3dad:496d:d711:e92b,fe80::3dad:496d:d711:e92b
  cs11Label=PrimaryAssetType cs11=Endpoint cs12Label=PrimaryAssetHostname cs12=testhost
  cs13Label=PrimaryAssetMAC cs13=f0:18:98:a9:b3:20 cs14Label=PrimaryAssetOS cs14=Mac
  OS X cs15Label=PrimaryAssetVendor cs15=Apple cs16Label=NonPrimaryAssetIP cs16= cs17Label=NonPrimaryAssetType
  cs17= cs18Label=NonPrimaryAssetHostname cs18= cs19Label=NonPrimaryAssetMAC cs19=
  cs20Label=NonPrimaryAssetOS cs20= cs21Label=NonPrimaryAssetVendor cs21= cn3Label=StoryId
  cn3=1  src=192.168.1.20 smac=f0:18:98:a9:b3:20 shost=Curtiss-Mini dst=192.168.1.10
  dmac=60:be:c4:ae:4d:b4 dhost=testhost externalId=15689 cat=Security msg=TCP from
  any port to port 7004'
- |
  <12>Jan 21 2022 00:34:11 claroty CEF:0|Claroty|CTD|4.2.2|Alert|Port Scan|5|rt=Jan 21 2022 00:34:11|start=Jan 21 2022 00:22:06 cn1Label=SiteId cn1=1 cs1Label=Site cs1=CS_TEST cs2Label=Network cs2=Default cs3Label=ResolvedAs cs3=Unresolved cs5Label=Src Zone cs5=Endpoint: Other cs6Label=Dst Zone cs6=Endpoint: Other cs7Label=Category cs7=Security cs8Label=AlertUrl cs8=https://192.168.1.110/alert/15631-1 outcome=Unresolved request=https://192.168.1.110/alert/15631-1 cn2Label=Alert Score cn2=100 cs10Label=PrimaryAssetIP cs10=192.168.1.20,192.168.1.79,192.168.1.93,fdac:2fd9:d2ff:41af:148d:e82e:cacb:bada,fdac:2fd9:d2ff:41af:3dad:496d:d711:e92b,fe80::3dad:496d:d711:e92b cs11Label=PrimaryAssetType cs11=Endpoint cs12Label=PrimaryAssetHostname cs12=testhost cs13Label=PrimaryAssetMAC cs13=f0:18:98:a9:b3:20 cs14Label=PrimaryAssetOS cs14=Mac OS X cs15Label=PrimaryAssetVendor cs15=Apple cs16Label=NonPrimaryAssetIP cs16= cs17Label=NonPrimaryAssetType cs17= cs18Label=NonPrimaryAssetHostname cs18= cs19Label=NonPrimaryAssetMAC cs19= cs20Label=NonPrimaryAssetOS cs20= cs21Label=NonPrimaryAssetVendor cs21= cn3Label=StoryId cn3=1  src=192.168.1.20 smac=f0:18:98:a9:b3:20 shost=testhost dst=192.168.1.52 dmac=00:8a:76:6f:53:ac dhost=iPad-Pro externalId=15631 cat=Security msg=TCP Port Scan: Asset 192.168.1.93 sent probe packets to 192.168.1.52 IP address on different ports.
$schema: https://schemas.humio.com/parser/v0.1.0
script: |-
  case {

  /<(?<priority>\d+)>(?<ingestTime>\D\S+\s+\S+\s+\S+\s+\S+)/
| parseCEF()
| parseTimestamp("MMM dd yyyy HH:mm:ss", field=cef.ext.start, timezone="Z");

  /(<(?<priority>\d+)>)?(?<ingestTime>\d{4}-\S+)\s\D+\s/
| parseCEF()
| parseTimestamp("MMM dd yyyy HH:mm:ss", field=cef.ext.rt, timezone="Z");

  }
| logType := "claroty"
tagFields: []
